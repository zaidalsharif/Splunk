<dashboard version="1.1" theme="dark">
  <label>System Performance</label>
  <description>CPU, Memory, Disk, Network Metrics</description>
  
  <row>
    <panel>
      <title>üìä Data Sources Active</title>
      <single>
        <search>
          <query>
| tstats count WHERE index=* earliest=-15m by index
| stats dc(index) as active_indexes
          </query>
          <earliest>-15m</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
      </single>
    </panel>
    <panel>
      <title>üñ•Ô∏è Reporting Hosts</title>
      <single>
        <search>
          <query>
| tstats dc(host) WHERE index=* earliest=-15m
          </query>
          <earliest>-15m</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xdc4e41","0xf8be34","0x53a051"]</option>
        <option name="rangeValues">[3,5]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üìà Events per Second</title>
      <single>
        <search>
          <query>
| tstats count WHERE index=* earliest=-5m
| eval eps = count / 300
| eval eps = round(eps, 2)
| fields eps
          </query>
          <earliest>-5m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="unit">eps</option>
      </single>
    </panel>
    <panel>
      <title>üíæ Total Events Today</title>
      <single>
        <search>
          <query>
| tstats count WHERE index=* earliest=@d
          </query>
          <earliest>@d</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
      </single>
    </panel>
  </row>

  <row>
    <panel>
      <title>Docker Container CPU Usage Over Time</title>
      <chart>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-4h
| rex field=cpu "(?&lt;cpu_pct&gt;[\d.]+)%"
| timechart span=5m avg(cpu_pct) by name limit=15
          </query>
          <earliest>-4h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleY.text">CPU %</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Docker Container Memory Usage Over Time</title>
      <chart>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-4h
| rex field=mem_perc "(?&lt;mem_pct&gt;[\d.]+)%"
| timechart span=5m avg(mem_pct) by name limit=15
          </query>
          <earliest>-4h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleY.text">Memory %</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Top CPU Consuming Containers (Current)</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-5m
| rex field=cpu "(?&lt;cpu_pct&gt;[\d.]+)%"
| stats latest(cpu_pct) as "CPU %" by name host
| sort -"CPU %"
| head 15
          </query>
          <earliest>-5m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel>
      <title>Top Memory Consuming Containers (Current)</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-5m
| rex field=mem_perc "(?&lt;mem_pct&gt;[\d.]+)%"
| stats latest(mem_pct) as "Memory %" latest(mem_usage) as "Usage" by name host
| sort -"Memory %"
| head 15
          </query>
          <earliest>-5m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Network I/O by Container</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-5m
| dedup name
| table name net_io host
| rename name as "Container" net_io as "Network I/O"
          </query>
          <earliest>-5m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel>
      <title>Block I/O by Container</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-5m
| dedup name
| table name block_io host
| rename name as "Container" block_io as "Block I/O"
          </query>
          <earliest>-5m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Event Volume by Index Over Time</title>
      <chart>
        <search>
          <query>
| tstats count WHERE index=* earliest=-24h by _time index span=1h
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Index Statistics</title>
      <table>
        <search>
          <query>
| tstats count WHERE index=* earliest=-24h by index
| sort -count
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel>
      <title>Sourcetype Statistics</title>
      <table>
        <search>
          <query>
| tstats count WHERE index=* earliest=-24h by sourcetype
| sort -count
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</dashboard>


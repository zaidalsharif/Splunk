<dashboard version="1.1" theme="dark">
  <label>Login Activity</label>
  <description>SSH Sessions, User Authentication, Login History</description>
  
  <row>
    <panel>
      <title>üîë Total Login Attempts (24h)</title>
      <single>
        <search>
          <query>index=security (Accepted OR Failed OR Invalid) earliest=-24h | stats count</query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
      </single>
    </panel>
    <panel>
      <title>‚úÖ Successful Logins</title>
      <single>
        <search>
          <query>index=security "Accepted" earliest=-24h | stats count</query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x53a051","0x53a051","0x53a051"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>‚ùå Failed Logins</title>
      <single>
        <search>
          <query>index=security "Failed password" earliest=-24h | stats count</query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[10,50]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>‚ö†Ô∏è Invalid Users</title>
      <single>
        <search>
          <query>index=security "Invalid user" earliest=-24h | stats count</query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[5,20]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <row>
    <panel>
      <title>Authentication Timeline</title>
      <chart>
        <search>
          <query>
index=security earliest=-24h
| rex "(?&lt;result&gt;Accepted|Failed|Invalid)"
| where isnotnull(result)
| timechart span=1h count by result
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.fieldColors">{"Accepted": 0x53a051, "Failed": 0xdc4e41, "Invalid": 0xf8be34}</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Successful Logins Details</title>
      <table>
        <search>
          <query>
index=security "Accepted" earliest=-24h
| rex "Accepted\s+(?&lt;auth_method&gt;\w+)\s+for\s+(?&lt;user&gt;\S+)\s+from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)\s+port\s+(?&lt;src_port&gt;\d+)"
| table _time host user src_ip src_port auth_method
| sort -_time
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
        <option name="count">15</option>
      </table>
    </panel>
    <panel>
      <title>User Login Count</title>
      <chart>
        <search>
          <query>
index=security "Accepted" earliest=-24h
| rex "for\s+(?&lt;user&gt;\S+)\s+from"
| stats count by user
| sort -count
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">pie</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Failed Login Attempts by Source IP</title>
      <table>
        <search>
          <query>
index=security ("Failed password" OR "Invalid user") earliest=-24h
| rex "from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "user\s+(?&lt;user&gt;\S+)"
| stats count as attempts first(_time) as first_attempt last(_time) as last_attempt dc(user) as unique_users by src_ip
| convert ctime(first_attempt) ctime(last_attempt)
| sort -attempts
| head 20
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel>
      <title>Targeted Usernames (Failed)</title>
      <chart>
        <search>
          <query>
index=security ("Failed password" OR "Invalid user") earliest=-24h
| rex "user\s+(?&lt;user&gt;\S+)"
| stats count by user
| sort -count
| head 15
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>SSH Sessions by Host</title>
      <chart>
        <search>
          <query>
index=security sshd earliest=-24h
| rex "(?&lt;action&gt;session opened|session closed)"
| where isnotnull(action)
| stats count by host action
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
    <panel>
      <title>Login Sources Geolocation</title>
      <table>
        <search>
          <query>
index=security (Accepted OR Failed) earliest=-24h
| rex "from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "(?&lt;result&gt;Accepted|Failed)"
| iplocation src_ip
| stats count by src_ip City Country result
| sort -count
| head 20
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Brute Force Detection (5+ failures from same IP in 10 min)</title>
      <table>
        <search>
          <query>
index=security "Failed password" earliest=-24h
| rex "from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| bin _time span=10m
| stats count by _time src_ip
| where count >= 5
| sort -_time -count
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel>
      <title>Authentication Methods</title>
      <chart>
        <search>
          <query>
index=security "Accepted" earliest=-24h
| rex "Accepted\s+(?&lt;auth_method&gt;\w+)"
| stats count by auth_method
          </query>
          <earliest>-24h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">pie</option>
      </chart>
    </panel>
  </row>
</dashboard>

